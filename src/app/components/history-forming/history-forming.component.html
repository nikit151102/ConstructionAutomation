<div class="docs-container">

    <div class="multiselect-container">
        <div class="multiselect-placeholder" (click)="toggleDropdown()">
            {{ selectedDocsLabel }}
        </div>
        <div class="multiselect-dropdown" *ngIf="dropdownOpen">
            <label *ngFor="let option of typeDocs" class="multiselect-option">
                <input type="checkbox" [checked]="isSelected(option)" (change)="toggleSelection(option)" />
                {{ option.name }}
            </label>
        </div>
    </div>



    <!-- Названия полей -->
    <div class="doc-fields">
        <div *ngFor="let field of fields">
            <div *ngIf="field.label" (click)="sortDocs(field.key)">
                {{ field.label }}
                <i class="pi" [ngClass]="{
                  'pi-sort-alt': currentSortField !== field.key,
                  'pi-sort-amount-up': currentSortField === field.key && isAscending,
                  'pi-sort-amount-up-alt': currentSortField === field.key && !isAscending
                }"></i>
            </div>
        </div>
    </div>

    <!-- Карточки -->
    <div *ngFor="let doc of filteredDocs" class="doc-card" [class.not-found]="doc.statusCode === 404"
        (click)="toggleAccordion(doc)">

        <div style="padding-left: 17px;">

            <div *ngIf="doc.statusCode === 0" class="status status-loading">
                <i class="pi pi-spin pi-spinner"></i> Загрузка
            </div>
            <div *ngIf="doc.statusCode === 1" class="status status-unpaid">
                <i class="pi pi-info-circle"></i> Не оплачено
            </div>
            <div *ngIf="doc.statusCode === 2" class="status status-success">
                <i class="pi pi-check"></i> Оплачен
            </div>
            <div *ngIf="doc.statusCode === 3" class="status status-danger">
                <i class="pi pi-times"></i> Ошибка
            </div>
            <div *ngIf="doc.statusCode === 4" class="status status-secondary">
                <i class="pi pi-ban"></i> Отменён
            </div>
        </div>
        <ng-container *ngIf="doc.statusCode === 0">
            <div class="skeleton skeleton-file-name"></div>
            <div class="skeleton skeleton-file-size"></div>
        </ng-container>
        <ng-container *ngIf="doc.statusCode !== 0">
            <div>{{ doc.FileName }}</div>
            <div>{{ doc.FileSize }}</div>
        </ng-container>
        <div>{{ doc.InitDate | date: 'dd-MM-yyyy' }}</div>

        <i class="pi" [ngClass]="{
                'pi-angle-down': expandedDoc !== doc,
                'pi-angle-up': expandedDoc === doc
              }" style="font-size: 1.5rem; cursor: pointer;"></i>

        <!-- Детали карточки -->
        <div *ngIf="expandedDoc === doc" class="card-details" (click)="$event.stopPropagation()">
            <p>Дополнительная информация:</p>
            <div class="actions">
                <ng-container *ngFor="let action of generateActions(doc.statusCode)">
                    <button [ngClass]="'action-button ' + action.class" (click)="action.command()">
                        <i [class]="'pi ' + action.icon"></i>
                        <span class="action-label">{{ action.label }}</span>
                    </button>
                </ng-container>
            </div>
        </div>

    </div>
</div>


<p-toast />


<app-pop-up *ngIf="visiblePopUpPay" [imageSrc]="'svg/pay.svg'" [title]="'Подтверждение оплаты'"
    [description]="'Вы уверены, что хотите оплатить?'" [buttons]="buttons" (close)="onPopupClose()">
</app-pop-up>
